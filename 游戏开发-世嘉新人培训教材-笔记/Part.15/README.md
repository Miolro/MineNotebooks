# 第十五章

## 类库的封装方法

类库依然使用 3DGraphics1  本章全是代码分析这边就不分章节写了

## 15.1 整体设计

构造一个 Model 类,输入形状,颜色,图案到类中然后调整角度调用 draw()函数将机甲绘制出来

### 15.1.1 资源与实例(resource instance)

抽象到到一个具体的过程,不管是皮鞋球鞋雨靴都是鞋(鞋就是作者所说的资源),将鞋具体化指向某一个物品那就是实例,泛指一类和单指一个物体

```C++
GraphicsResource resource("robo.resource"); // 将图纸传入
GraphicsInstance instance(resource);        // 生成一个实例
instance.setPosition(Vector(0,0,0));        // 设置一个位置
instance.draw();                            // 绘制出来
```

代码主要分为 顶点坐标类,顶点索引类,整合类,相机类,模型类,主方法,其他数学矩阵和向量(不做分析)

## 各个类的作用

- 坐标类:管理角点(三维Vector)和UV贴图坐标(二维Vector)
- 索引类:管理三角形组的顶点索引坐标一组的三个的unsigned索引
- 整合类:
  - 处理批量索引点(角点)对点(UV)模型贴图
  - 角点自身变化进行处理(视角变化,世界旋转,模型旋转)
- 相机类:设置视角
- 模型类:设置保存模型的位置角度,调用Batch的绘制
- 主方法:保存全局的世界变换矩阵,角点信息,角点索引信息,代码初始化

`按照数字顺序往下读然后回过头读下一个数字的内容`

## 坐标类(VertexBuffer)

1.将外部的坐标(角点/UV贴图坐标)角点数量保存起来  
1.内部设置通过get/set方法和外部交互  
1.内容上没什么可以说的

## 顶点索引类(IndexBuffer)

1.保存顶点索引数组和大小  
1.内部设置通过get/set方法和外部交互  
1.内容上没什么可以说的

## 整合类(Batch)

1.将坐标和顶点索引连接起来  
2.世界变换矩阵处理渲染角点信息  
2.循环索引组数做贴图drawTriangle3DH  

## 模型类(Model)

1.首先整合类已经把点和点都保存好了  
1.处理自身的变化(位移,缩放,旋转)  
1.接下去交给Batch做贴图并把模型放入世界

## 相机类(Carmen)

1.初始化世界矩阵

## 结构关系

坐标类->整合类  
索引类->整合类  
相机类->模型类->整合类  

